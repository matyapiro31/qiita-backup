修正しました｡処理を減らせないかと思ったんですが､できないみたいですね｡
そこらへんはあまりこだわってないです｡
